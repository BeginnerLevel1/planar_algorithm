package com.huifer.planar.aset.algo.impl.concave;

import com.huifer.planar.aset.algo.impl.concave.ConcaveSplit.TroughLineWithSort;
import org.junit.Test;
import org.locationtech.jts.geom.Geometry;
import org.locationtech.jts.geom.GeometryFactory;
import org.locationtech.jts.geom.Polygon;
import org.locationtech.jts.io.WKTReader;

import java.util.List;

public class ConcaveSplitTest {

    @Test
    public void testSplit() throws Exception {
//        Geometry rs = new WKTReader()
//                .read("POLYGON ((88057.0949382782 73718.7540149689,88057.1911640167 73718.8625087738,88057.1911640167 73718.768743515,88057.2341899872 73718.8586025238,88057.2341899872 73718.764837265,88057.3026218414 73718.8488330841,88057.3801059723 73718.7857074738,88057.3436870575 73718.8781375885,88057.4395008087 73718.8097667694,88057.4142856598 73718.8996257782,88057.3221759796 73718.8996257782,88057.4730167389 73718.9779834747,88057.3797969818 73719.0276966095,88057.3280467987 73718.9484615326,88057.3280467987 73719.0363636017,88057.2029056549 73718.9992465973,88057.2830753326 73718.9113445282,88057.1618366241 73718.9836215973,88057.2400493622 73718.9015750885,88057.0934047699 73718.9445514679,88057.1729488373 73718.8777980804,88057.0025119781 73718.8623485565,88057.1355304718 73718.8424167633,88057.0949382782 73718.7540149689))");

//        Geometry rs = new WKTReader()
//                .read("POLYGON ((88064.3489745457 73720.9215322899,88064.123424185 73716.9969560137,88068.4765461465 73716.0947545709,88068.950201904 73719.1396844404,88066.8074734774 73717.4931668073,88067.348794343 73720.312546316,88065.7022767099 73718.4855883943,88066.063157287 73721.7109585523,88064.9579605196 73719.4780099814,88064.3489745457 73720.9215322899))");
        // 内部线构造有问题
        Geometry rs = new WKTReader()
                .read("POLYGON ((88064.0209026337 73719.926618576,88065.280916214 73720.9421520233,88066.9358577728 73719.719751358,88066.9358577728 73720.719751358,88068.1582584381 73719.6257190704,88068.1958713531 73722.1269397736,88067.0298862457 73721.2430477142,88066.0895786285 73721.8824596405,88065.0895786285 73721.8824596405,88065.0895786285 73720.8824596405,88063.8328418732 73721.7884273529,88064.0209026337 73719.926618576))");

        // 内部线构造有问题
//        Geometry rs = new WKTReader()
//                .read("POLYGON ((88057.0949385612 73718.7540124811,88056.9864420504 73718.8502387442,88057.0802076503 73718.8502387442,88056.9903508125 73718.8932625208,88057.0841129746 73718.8932625208,88057.0001175611 73718.9616934149,88057.0632440986 73719.0391780026,88056.9708138774 73719.0027607641,88057.0391845557 73719.0985728286,88056.949327718 73719.0733595913,88056.949327718 73718.9812488758,88056.8709680886 73719.1320881442,88056.8212546963 73719.0388694587,88056.9004905369 73718.9871181579,88056.8125897991 73718.9871181579,88056.8497041315 73718.8619773084,88056.9376083072 73718.9421467667,88056.8653323045 73718.8209099592,88056.9473750558 73718.8991229901,88056.9043992991 73718.752479065,88056.9711526456 73718.8320203486,88056.9866036263 73718.6615845072,88057.0065359067 73718.7946039426,88057.0949385612 73718.7540124811))");

        ////////////////////////////////////////////
//        Geometry rs = new WKTReader()
//                .read("POLYGON ((88071.788411818 73723.6556232471,88070.9045197586 73724.8216083545,88071.5439316849 73725.7619159717,88071.5439316849 73726.7619159717,88070.5439316849 73726.7619159717,88071.4498993973 73728.018652727,88069.3406266759 73727.9543239389,88067.6535363226 73725.9870205741,88069.064532433 73725.1120251441,88070.3308828244 73726.8693949039,88070.6036240677 73726.5705783862,88069.3812234024 73724.9156368274,88070.3812234025 73724.9156368274,88069.2871911148 73723.6932361621,88071.788411818 73723.6556232471))");

        // 闭环的时候出现问题
//        Geometry rs = new WKTReader()
//                .read("POLYGON ((88075.4230267276 73722.549590726,88076.0624386539 73723.4898983432,88076.0624386539 73724.4898983432,88075.0624386539 73724.4898983432,88075.9684063663 73725.7466350986,88074.1065975894 73725.5585743381,88075.1221310367 73724.2985607578,88073.8997303714 73722.6436191989,88074.8997303714 73722.6436191989,88073.8056980838 73721.4212185336,88076.3069187869 73721.3836056186,88075.4230267276 73722.549590726))");

        Polygon polygon = new GeometryFactory().createPolygon(rs.getCoordinates());

        List<TroughLineWithSort> splitLine = ConcaveSplit.split(polygon);

    }

}
